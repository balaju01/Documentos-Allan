#include <stdio.h>
#include <stdlib.h>
void analizatrama(unsigned char T[]);
	char supervision[][5]={"RR","RNR","REJ","SREJ"};
	char UC[][32]={"UI","SIM","NR0","SARM","UP","-","-","SABM","DISC","-","NR2","SARME","UA","-","-","SABME","SNRM","FRMR","NR1","RSET","-","-","-","XID","-","CFGR","NR3","SNRME","TEST","-","-","BCN","-"};
	char UR[][32]={"UI","RIM","NR0","DM","-","-","-","-","RD","-","NR2","-","-","-","-","-","-","-","NR1","-","-","-","-","XID","-","CFGR","NR3","-","TEST","-","-","-","-"};		
int main()
{
	
    unsigned char T1[]={0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xaf,0x1b,0x00,0x03,0xf0,0xf0,0x7f,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
    //unsigned char TX[]={0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0X02,0xb3,0x9c,0xdf,0x1b,0x08,0x06,0x01,0x1b}; 
    unsigned char T3[]={0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xaf,0x1b,0x00,0x03,0xf0,0xf1,0x73,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
	unsigned char T5[]={0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x12,0xf0,0xf0,0x00,0x01,0x0e,0x00,0xff,0xef,0x19,0x8f,0xbc,0x05,0x7f,0x00,0x23,0x00,0x7f,0x23};
  analizatrama(T1);
  //analizatrama(TX);
  analizatrama(T3);
  analizatrama(T5);
  
  system("PAUSE");	
  return 0;
}

void analizatrama(unsigned char T[]){ 
     int tamatipo;	  
     tamatipo=T[12]*256+T[13];
     if (tamatipo<=1500){
	 
     printf("Trama LLC\n");
     /*else{
          printf("Trama Ethernet\n"); 
          }*/
     if (tamatipo<=1500)
	 switch (T[17] & 1){
	 	case 1://T-I
	 	printf("N(s)= %d, N(r)= %d\n", (T[17] >> 1) & 127,(T[16] >> 1) & 127);
	 	break;
		case 2://T-S
		printf("%s, N(s)= %d ", supervision[(T[17] & 48) >> 4],(T[16] >> 1) & 127);
		break;
		case 3://T-U
		if(T[16]>>2&3){
			if(T[16]>>6&3)
				printf("%s -f", UR[(T[17]>>4) & 1]);
			else 
				printf("%s -p", UC[(T[17]>>4) & 1]);
		}
		break;
	 }  
     }
     }
     
